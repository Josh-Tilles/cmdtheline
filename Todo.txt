clean up optional arguments
formalize tests
comments
haddock
